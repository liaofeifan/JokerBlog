<!doctype html><html lang="zh" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="This is my personal blog"><link rel="canonical" href="http://blog.jokerhub.cn/docker/Container/"><meta name="author" content="wangzhizhou"><meta name="lang:clipboard.copy" content="复制"><meta name="lang:clipboard.copied" content="已复制"><meta name="lang:search.language" content="ja"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="没有找到符合条件的结果"><meta name="lang:search.result.one" content="找到 1 个符合条件的结果"><meta name="lang:search.result.other" content="# 个符合条件的结果"><meta name="lang:search.tokenizer" content="[\uff0c\u3002]+"><link rel="shortcut icon" href="../../img/favicon.ico"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>容器 - Joker Blog</title><link rel="stylesheet" href="../../assets/stylesheets/application.4031d38b.css"><link rel="stylesheet" href="../../assets/stylesheets/application-palette.224b79ff.css"><meta name="theme-color" content="#4caf50"><script src="../../assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,400,400i,700|Ubuntu+Mono&display=swap"><style>body,input{font-family:"Roboto Slab","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="../../assets/fonts/material-icons.css"><link rel="stylesheet" href="../../stylesheets/extra.css"><script>window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-36723568-3", "mkdocs.org")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })</script><script async src="https://www.google-analytics.com/analytics.js"></script></head><body dir="ltr" data-md-color-primary="green" data-md-color-accent="orange"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#_1" tabindex="1" class="md-skip">跳转至 </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="http://blog.jokerhub.cn" title="Joker Blog" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">Joker Blog</span><span class="md-header-nav__topic">容器</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">键入以开始搜索</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/wangzhizhou/JokerBlog/" title="前往 Github 仓库" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">JokerBlog</div></a></div></div></div></nav></header><div class="md-container"><nav class="md-tabs md-tabs--active" data-md-component="tabs"><div class="md-tabs__inner md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a href="../.." title="主页" class="md-tabs__link">主页</a></li><li class="md-tabs__item"><a href="../../job/My Plan for finding Job/" title="工作" class="md-tabs__link">工作</a></li><li class="md-tabs__item"><a href="../../life/alipay-scan-fu-icon/" title="生活" class="md-tabs__link">生活</a></li><li class="md-tabs__item"><a href="../../geek/wireguard/" title="Geek" class="md-tabs__link md-tabs__link--active">Geek</a></li><li class="md-tabs__item"><a href="../../me/My Financial Planning/" title="关于我" class="md-tabs__link">关于我</a></li></ul></div></nav><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="http://blog.jokerhub.cn" title="Joker Blog" class="md-nav__button md-logo"><i class="md-icon"></i></a>Joker Blog</label><div class="md-nav__source"><a href="https://github.com/wangzhizhou/JokerBlog/" title="前往 Github 仓库" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">JokerBlog</div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1"><label class="md-nav__link" for="nav-1">主页</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-1">主页</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../.." title="简介" class="md-nav__link">简介</a></li><li class="md-nav__item"><a href="../../How I create this blog/" title="博客创建过程" class="md-nav__link">博客创建过程</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"><label class="md-nav__link" for="nav-2">工作</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">工作</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../job/My Plan for finding Job/" title="求职" class="md-nav__link">求职</a></li><li class="md-nav__item"><a href="../../job/dimission/" title="离职" class="md-nav__link">离职</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"><label class="md-nav__link" for="nav-3">生活</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">生活</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../life/alipay-scan-fu-icon/" title="支付宝集福" class="md-nav__link">支付宝集福</a></li><li class="md-nav__item"><a href="../../life/Renting in Beijing/" title="北京租房" class="md-nav__link">北京租房</a></li><li class="md-nav__item"><a href="../../life/Gu Bei Shui Zhen/" title="古北水镇游玩" class="md-nav__link">古北水镇游玩</a></li><li class="md-nav__item"><a href="../../life/WuZhen/" title="乌镇游玩" class="md-nav__link">乌镇游玩</a></li><li class="md-nav__item"><a href="../../minecraft/minecraft/" title="我的世界游戏" class="md-nav__link">我的世界游戏</a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked><label class="md-nav__link" for="nav-4">Geek</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">Geek</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../geek/wireguard/" title="WireGuard" class="md-nav__link">WireGuard</a></li><li class="md-nav__item"><a href="../../geek/Git/" title="Git核心技能" class="md-nav__link">Git核心技能</a></li><li class="md-nav__item"><a href="../../geek/Network Simulator 2 Installation Guide for Ubuntu/" title="Ubuntu安装NS2网络模拟器" class="md-nav__link">Ubuntu安装NS2网络模拟器</a></li><li class="md-nav__item"><a href="../../geek/Learn STL In 30 Minutes/" title="30分钟掌握STL" class="md-nav__link">30分钟掌握STL</a></li><li class="md-nav__item"><a href="../../geek/Installation of Ubuntu 16.04 On UDisk/" title="U盘安装Ubuntu" class="md-nav__link">U盘安装Ubuntu</a></li><li class="md-nav__item"><a href="../../geek/Configure Git Server With Ubuntn and Apache 2/" title="搭建Git服务" class="md-nav__link">搭建Git服务</a></li><li class="md-nav__item"><a href="../../geek/User OpenCV to add watermark on a video/" title="OpenCV给视频添加水印" class="md-nav__link">OpenCV给视频添加水印</a></li><li class="md-nav__item"><a href="../../geek/Add Watermark on Video with OpenCV and FFmpeg/" title="OpenCV+FFmpeg给视频添加水印" class="md-nav__link">OpenCV+FFmpeg给视频添加水印</a></li><li class="md-nav__item"><a href="../../geek/Develop DLNA Using Platinum Library/" title="DLNA开发" class="md-nav__link">DLNA开发</a></li><li class="md-nav__item"><a href="../../geek/Nmap Basics/" title="Nmap基础" class="md-nav__link">Nmap基础</a></li><li class="md-nav__item"><a href="../../geek/Use GDB/" title="GDB使用" class="md-nav__link">GDB使用</a></li><li class="md-nav__item"><a href="../../geek/kotlin/" title="Kotlin学习" class="md-nav__link">Kotlin学习</a></li><li class="md-nav__item"><a href="../../geek/jupyterhub/" title="jupyterhub工具使用" class="md-nav__link">jupyterhub工具使用</a></li><li class="md-nav__item"><a href="../../geek/bluegogo-crack/" title="bluegogo破解" class="md-nav__link">bluegogo破解</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-15" type="checkbox" id="nav-4-15"><label class="md-nav__link" for="nav-4-15">FFmpeg</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-15">FFmpeg</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../geek/FFmpeg and SDL tutorial 1/" title="FFmpeg教程" class="md-nav__link">FFmpeg教程</a></li><li class="md-nav__item"><a href="../../geek/FFmpeg compiled on MacOS/" title="Mac上编译FFmpeg" class="md-nav__link">Mac上编译FFmpeg</a></li><li class="md-nav__item"><a href="../../geek/FFmpeg version 3.1.4 example code/" title="FFmpeg示例代码学习" class="md-nav__link">FFmpeg示例代码学习</a></li><li class="md-nav__item"><a href="../../geek/Fmpeg 2.8.6 example code - transcoding/" title="FFmpeg转码学习" class="md-nav__link">FFmpeg转码学习</a></li><li class="md-nav__item"><a href="../../geek/Convert MP4 to GIF With FFmpeg/" title="使用FFmpeg将MP4转成GIF图片" class="md-nav__link">使用FFmpeg将MP4转成GIF图片</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-16" type="checkbox" id="nav-4-16"><label class="md-nav__link" for="nav-4-16">Jenkins</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-16">Jenkins</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../jenkins/guide/" title="导览" class="md-nav__link">导览</a></li><li class="md-nav__item"><a href="../../jenkins/guide/first-pipeline/" title="第一个管道" class="md-nav__link">第一个管道</a></li><li class="md-nav__item"><a href="../../jenkins/guide/multiple-steps-pipeline/" title="多步管道" class="md-nav__link">多步管道</a></li><li class="md-nav__item"><a href="../../jenkins/guide/define-execution-environments/" title="定义执行环境" class="md-nav__link">定义执行环境</a></li><li class="md-nav__item"><a href="../../jenkins/guide/using-environment-variables/" title="使用环境变量" class="md-nav__link">使用环境变量</a></li><li class="md-nav__item"><a href="../../jenkins/guide/recording-test-results-and-artifacts/" title="记录测试结果" class="md-nav__link">记录测试结果</a></li><li class="md-nav__item"><a href="../../jenkins/guide/cleaning-up-and-notification/" title="清理和通知" class="md-nav__link">清理和通知</a></li><li class="md-nav__item"><a href="../../jenkins/guide/deployment/" title="布署" class="md-nav__link">布署</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-17" type="checkbox" id="nav-4-17"><label class="md-nav__link" for="nav-4-17">ReactiveX</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-17">ReactiveX</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../reactiveX/introduction/" title="介绍" class="md-nav__link">介绍</a></li><li class="md-nav__item"><a href="../../reactiveX/Observable/" title="可观察的" class="md-nav__link">可观察的</a></li><li class="md-nav__item"><a href="../../reactiveX/Operators/" title="运算符" class="md-nav__link">运算符</a></li><li class="md-nav__item"><a href="../../reactiveX/Single/" title="单事件可观察对象" class="md-nav__link">单事件可观察对象</a></li><li class="md-nav__item"><a href="../../reactiveX/Subject/" title="主题" class="md-nav__link">主题</a></li><li class="md-nav__item"><a href="../../reactiveX/Scheduler/" title="调度器" class="md-nav__link">调度器</a></li></ul></nav></li><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-18" type="checkbox" id="nav-4-18" checked><label class="md-nav__link" for="nav-4-18">Docker</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-18">Docker</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../start-learn/" title="简介" class="md-nav__link">简介</a></li><li class="md-nav__item"><a href="../Orientation/" title="定位" class="md-nav__link">定位</a></li><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><a href="./" title="容器" class="md-nav__link md-nav__link--active">容器</a></li><li class="md-nav__item"><a href="../Service/" title="服务" class="md-nav__link">服务</a></li><li class="md-nav__item"><a href="../Swarm/" title="机群" class="md-nav__link">机群</a></li><li class="md-nav__item"><a href="../Stack/" title="栈" class="md-nav__link">栈</a></li><li class="md-nav__item"><a href="../Deploy/" title="部署应用" class="md-nav__link">部署应用</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-19" type="checkbox" id="nav-4-19"><label class="md-nav__link" for="nav-4-19">Nginx</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-19">Nginx</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../nginx/beginner-guide/" title="新手教程" class="md-nav__link">新手教程</a></li><li class="md-nav__item"><a href="../../nginx/application/" title="主要用途" class="md-nav__link">主要用途</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-20" type="checkbox" id="nav-4-20"><label class="md-nav__link" for="nav-4-20">iOS</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-20">iOS</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../iOS/workflow/" title="工作流" class="md-nav__link">工作流</a></li><li class="md-nav__item"><a href="../../iOS/XCode 9 CI/" title="持续集成" class="md-nav__link">持续集成</a></li><li class="md-nav__item"><a href="../../iOS/swift4-notes/" title="Swift4" class="md-nav__link">Swift4</a></li><li class="md-nav__item"><a href="../../iOS/swift5-notes/" title="Swift5" class="md-nav__link">Swift5</a></li><li class="md-nav__item"><a href="../../geek/swift on client and server/" title="Swift在客户端和服务端的使用" class="md-nav__link">Swift在客户端和服务端的使用</a></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-20-6" type="checkbox" id="nav-4-20-6"><label class="md-nav__link" for="nav-4-20-6">服务端Swift</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-20-6">服务端Swift</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../iOS/swift-on-server/[4]Swift-Package-Manager/" title="第四章Swfit包管理器" class="md-nav__link">第四章Swfit包管理器</a></li><li class="md-nav__item"><a href="../../iOS/swift-on-server/[5]Writng-ToDoList-With-Kitura/" title="第五章使用Kitura写ToDoList" class="md-nav__link">第五章使用Kitura写ToDoList</a></li></ul></nav></li><li class="md-nav__item"><a href="../../iOS/objc/" title="OC相关" class="md-nav__link">OC相关</a></li><li class="md-nav__item"><a href="../../iOS/reverse/" title="逆向工程" class="md-nav__link">逆向工程</a></li><li class="md-nav__item"><a href="../../iOS/optimization/" title="应用优化" class="md-nav__link">应用优化</a></li><li class="md-nav__item"><a href="../../geek/Optimizing App Startup Time/" title="优化应用启动时长" class="md-nav__link">优化应用启动时长</a></li><li class="md-nav__item"><a href="../../iOS/review/" title="面试" class="md-nav__link">面试</a></li><li class="md-nav__item"><a href="../../iOS/job-plan/" title="面试准备资料" class="md-nav__link">面试准备资料</a></li><li class="md-nav__item"><a href="../../iOS/sort/" title="十大排序算法" class="md-nav__link">十大排序算法</a></li><li class="md-nav__item"><a href="../../iOS/runtime/" title="OC运行时编译" class="md-nav__link">OC运行时编译</a></li><li class="md-nav__item"><a href="../../iOS/TPG/" title="线程编码指南" class="md-nav__link">线程编码指南</a></li><li class="md-nav__item"><a href="../../iOS/CPG/" title="并发编码指南" class="md-nav__link">并发编码指南</a></li><li class="md-nav__item"><a href="../../iOS/design-pattern/" title="设计模式" class="md-nav__link">设计模式</a></li><li class="md-nav__item"><a href="../../iOS/TDD/" title="测试驱动开发" class="md-nav__link">测试驱动开发</a></li><li class="md-nav__item"><a href="../../iOS/airdrop/" title="AirDrop社交" class="md-nav__link">AirDrop社交</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21" type="checkbox" id="nav-4-21"><label class="md-nav__link" for="nav-4-21">乐理基础</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-21">乐理基础</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21-1" type="checkbox" id="nav-4-21-1"><label class="md-nav__link" for="nav-4-21-1">乐音</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-21-1">乐音</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../music/theory/tones/Pitches and Clefs/" title="音高和谱号" class="md-nav__link">音高和谱号</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21-2" type="checkbox" id="nav-4-21-2"><label class="md-nav__link" for="nav-4-21-2">节拍</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-21-2">节拍</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../music/theory/rhythms/Note Values and Basic Notation/" title="Note Values and Basic Notation" class="md-nav__link">Note Values and Basic Notation</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21-3" type="checkbox" id="nav-4-21-3"><label class="md-nav__link" for="nav-4-21-3">曲调</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-21-3">曲调</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../music/theory/tunes/Melodies/" title="Melodies" class="md-nav__link">Melodies</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21-4" type="checkbox" id="nav-4-21-4"><label class="md-nav__link" for="nav-4-21-4">伴奏</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-21-4">伴奏</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../music/theory/accompanying/Transcribing What You Hear/" title="Transcribing What You Hear" class="md-nav__link">Transcribing What You Hear</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21-5" type="checkbox" id="nav-4-21-5"><label class="md-nav__link" for="nav-4-21-5">修饰</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-21-5">修饰</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../music/theory/embellishing/Harmony and Counterpoint/" title="Harmony and Counterpoint" class="md-nav__link">Harmony and Counterpoint</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21-6" type="checkbox" id="nav-4-21-6"><label class="md-nav__link" for="nav-4-21-6">编曲</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-21-6">编曲</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../music/theory/arranging/composing and arranging for voices and instruments/" title="Composing and arranging for voices and instruments" class="md-nav__link">Composing and arranging for voices and instruments</a></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-21-7" type="checkbox" id="nav-4-21-7"><label class="md-nav__link" for="nav-4-21-7">附录</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-4-21-7">附录</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../music/theory/appendixes/A/" title="A" class="md-nav__link">A</a></li></ul></nav></li></ul></nav></li></ul></nav></li><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"><label class="md-nav__link" for="nav-5">关于我</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">关于我</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="../../me/My Financial Planning/" title="理财" class="md-nav__link">理财</a></li><li class="md-nav__item"><a href="../../me/Life in Beijing/" title="人在北京" class="md-nav__link">人在北京</a></li><li class="md-nav__item"><a href="../../me/my hardware/" title="硬件" class="md-nav__link">硬件</a></li><li class="md-nav__item"><a href="../../me/Personal Pre-Work Record/" title="早起记录" class="md-nav__link">早起记录</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/wangzhizhou/JokerBlog/edit/master/docs/docker/Container.md" title="编辑此页" class="md-icon md-content__icon">&#xE3C9;</a><p>是时候用<code class="codehilite"><span class="n">docker</span></code>的方式构建一个应用了。我们首先从应用结构的最底层(容器)开始。在容器层上面是服务层，定义了容器在生产环境下的表现，在最上层是栈，定义了所有服务之间的交互关系。</p>
<p>应用结构如下：</p>
<ul>
<li>栈</li>
<li>服务</li>
<li>容器(我们现在在这个位置)</li>
</ul>
<h1 id="_1">崭新的开始环境<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>在这之前，如果你要开始开发一个python应用，首先要在自己的机器上搭一个python运行环境。但是，这样的话，服务器上的python运行环境也必须和你开发机器上的环境一致。</p>
<p>有了<code class="codehilite"><span class="n">Docker</span></code>，你可以使用镜像的方式获取python环境，不需要安装，你可以在这个环境下开发你的应用，并把应用集成进这个镜像中，这样应用、运行环境和依赖库都在一个统一的地方，可以在部署时一起移动。</p>
<p>这个可移动的镜像可以通过一个名为<code class="codehilite"><span class="n">Dockerfile</span></code>的文件来定义。</p>
<h1 id="dockerfile">用<code class="codehilite"><span class="n">Dockerfile</span></code>来定义容器<a class="headerlink" href="#dockerfile" title="Permanent link">&para;</a></h1>
<p><code class="codehilite"><span class="n">Dockerfile</span></code>定义在容器内部执行的步骤。访问资源如网络接口以及磁盘驱动器可以在容器内部进行，这就隔离了与其它系统的交互。但是为了真正的访问外部世界，你需要做一些端口映射和文件拷贝工作从而与外部世界建立联系。只要这一过程完成，你就可以确保你的应用在任何地方运行都是一致的。</p>
<p>首先创建一个空目录，然后在这个目录下面建立一个名为<code class="codehilite"><span class="n">Dockerfile</span></code>的文件。注意下面文件内容中的注释，可以帮你更好的理解工作原理：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">#</span> <span class="n">Use</span> <span class="n">an</span> <span class="n">official</span> <span class="n">Python</span> <span class="n">runtime</span> <span class="k">as</span> <span class="n">a</span> <span class="n">parent</span> <span class="n">image</span>
<span class="k">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mi">2</span><span class="p">.</span><span class="mi">7</span><span class="o">-</span><span class="n">slim</span>

<span class="o">#</span> <span class="k">Set</span> <span class="n">the</span> <span class="n">working</span> <span class="n">directory</span> <span class="k">to</span> <span class="o">/</span><span class="n">app</span>
<span class="n">WORKDIR</span> <span class="o">/</span><span class="n">app</span>

<span class="o">#</span> <span class="k">Copy</span> <span class="n">the</span> <span class="k">current</span> <span class="n">directory</span> <span class="n">contents</span> <span class="k">into</span> <span class="n">the</span> <span class="n">container</span> <span class="k">at</span> <span class="o">/</span><span class="n">app</span>
<span class="k">ADD</span> <span class="p">.</span> <span class="o">/</span><span class="n">app</span>

<span class="o">#</span> <span class="n">Install</span> <span class="k">any</span> <span class="n">needed</span> <span class="n">packages</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="o">#</span> <span class="n">Make</span> <span class="n">port</span> <span class="mi">80</span> <span class="n">available</span> <span class="k">to</span> <span class="n">the</span> <span class="n">world</span> <span class="n">outside</span> <span class="n">this</span> <span class="n">container</span>
<span class="n">EXPOSE</span> <span class="mi">80</span>

<span class="o">#</span> <span class="n">Define</span> <span class="n">environment</span> <span class="k">variable</span>
<span class="n">ENV</span> <span class="n">NAME</span> <span class="n">World</span>

<span class="o">#</span> <span class="n">Run</span> <span class="n">app</span><span class="p">.</span><span class="n">py</span> <span class="k">when</span> <span class="n">the</span> <span class="n">container</span> <span class="n">launches</span>
<span class="n">CMD</span> <span class="p">[</span><span class="ss">&quot;python&quot;</span><span class="p">,</span> <span class="ss">&quot;app.py&quot;</span><span class="p">]</span>
</pre></div>
</td></tr></table>

<p>这个<code class="codehilite"><span class="n">Dockerfile</span></code>中引用到的一些其它文件像<code class="codehilite"><span class="n">app</span><span class="p">.</span><span class="n">py</span></code>和<code class="codehilite"><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span></code>还没有提到。我们在接下来的部分中创建它们。</p>
<h2 id="_2">应用本身<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>把下面的两个文件放在与<code class="codehilite"><span class="n">Dockerfile</span></code>相同的目录下。那两个文件就是我们完整的应用，实现过程很简单。当我们要创建镜像时，<code class="codehilite"><span class="n">app</span><span class="p">.</span><span class="n">py</span></code>和<code class="codehilite"><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span></code>文件会被放入镜像中，因为我们使用了指令<code class="codehilite"><span class="k">ADD</span></code>，同时，应用的输出也会被外部访问到，因为我们使用指令<code class="codehilite"><span class="n">EXPOSE</span></code>暴露了端口至外部。</p>
<p><strong>requirements.txt</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Flask</span>
<span class="n">Redis</span>
</pre></div>
</td></tr></table>

<p><strong>app.py</strong></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">redis</span> <span class="kn">import</span> <span class="n">Redis</span><span class="p">,</span> <span class="n">RedisError</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">socket</span>

<span class="c1"># Connect to Redis</span>
<span class="n">redis</span> <span class="o">=</span> <span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;redis&quot;</span><span class="p">,</span> <span class="n">db</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">socket_connect_timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">socket_timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">visits</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s2">&quot;counter&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">RedisError</span><span class="p">:</span>
        <span class="n">visits</span> <span class="o">=</span> <span class="s2">&quot;&lt;i&gt;cannot connect to Redis, counter disabled&lt;/i&gt;&quot;</span>

    <span class="n">html</span> <span class="o">=</span> <span class="s2">&quot;&lt;h3&gt;Hello {name}!&lt;/h3&gt;&quot;</span> \
           <span class="s2">&quot;&lt;b&gt;Hostname:&lt;/b&gt; {hostname}&lt;br/&gt;&quot;</span> \
           <span class="s2">&quot;&lt;b&gt;Visits:&lt;/b&gt; {visits}&quot;</span>
    <span class="k">return</span> <span class="n">html</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;NAME&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">),</span> <span class="n">hostname</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">(),</span> <span class="n">visits</span><span class="o">=</span><span class="n">visits</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>现在我们来看<code class="codehilite"><span class="n">Dockerfile</span></code>文件里的指令<code class="codehilite"><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="p">.</span><span class="n">txt</span></code>安装了依赖库<code class="codehilite"><span class="n">Flask</span></code>和<code class="codehilite"><span class="n">Redis</span></code>,并且应用的输出是打环境变量<code class="codehilite"><span class="n">NAME</span></code>和通过调用命令<code class="codehilite"><span class="nv">socket</span>.<span class="k">gethostname</span><span class="ss">()</span></code>来输出机器名称。由于<code class="codehilite"><span class="n">Redis</span></code>还没有运行起来，我们的应用如果此时被运行，应该是会失败并产生错误信息输出。</p>
<p><strong>注意</strong>：在容器内部获得的机器名称是容器的ID，这个ID类似于进程ID。</p>
<h2 id="_3">构建应用<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>宿主系统上不需要安装<code class="codehilite"><span class="n">python</span></code>和<code class="codehilite"><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span></code>中所列的依赖，这些东西也不会在构建过程中安装在宿主系统上。这看上出不可能，但你确实已经可以建立起一个应用的开发环境了。</p>
<p>先来看下目录下面有什么内容：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ ls
Dockerfile        app.py            requirements.txt
</pre></div>
</td></tr></table>

<p>下面我们运行构建命令来建立我们的<code class="codehilite"><span class="n">Docker</span></code>镜像。我们使用<code class="codehilite"><span class="o">-</span><span class="n">t</span></code>选项为我们构建的镜像指定一个友好的名称，方便之后的使用。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker build -t friendlyhello .
</pre></div>
</td></tr></table>

<p>运行成功后，构建的镜像会在你本地的<code class="codehilite"><span class="n">Docker</span></code>镜像登记处。以下命令查看：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker images
REPOSITORY              TAG                 IMAGE ID            CREATED                  SIZE
friendlyhello           latest              dd76f8897238        Less than a second ago   194MB
</pre></div>
</td></tr></table>

<h2 id="_4">运行应用<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>使用下面的命令将宿主机的<code class="codehilite"><span class="mi">4000</span></code>端口映射到容器的<code class="codehilite"><span class="mi">80</span></code>端口，<code class="codehilite"><span class="o">-</span><span class="n">p</span></code>选项可以用来指定端口映射：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker run -p <span class="m">4000</span>:80 friendlyhello
 * Running on http://0.0.0.0:80/ <span class="o">(</span>Press CTRL+C to quit<span class="o">)</span>
</pre></div>
</td></tr></table>

<p>你会看到我们的python应用在<code class="codehilite"><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">.</span><span class="mi">0</span><span class="p">:</span><span class="mi">80</span></code>地址向外部提供服务。但是容器的内部端口<code class="codehilite"><span class="mi">80</span></code>已经被映射为宿主机的<code class="codehilite"><span class="mi">4000</span></code>端口，所以我们需要访问:<a href="http://localhost:4000">http://localhost:4000</a>,我们会看到下面的场景：</p>
<p><img alt="docker-app" src="/docker/image/docker-app.png" /></p>
<p>你也可以使用命令行来访问我们的应用:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ <span class="nv">curl</span> <span class="nv">http</span>:<span class="o">//</span><span class="nv">localhost</span>:<span class="mi">4000</span>
<span class="o">&lt;</span><span class="nv">h3</span><span class="o">&gt;</span><span class="nv">Hello</span> <span class="nv">world</span><span class="o">!&lt;/</span><span class="nv">h3</span><span class="o">&gt;&lt;</span><span class="nv">b</span><span class="o">&gt;</span><span class="nv">Hostname</span>:<span class="o">&lt;/</span><span class="nv">b</span><span class="o">&gt;</span> <span class="nv">d10c1e1c27c4</span><span class="o">&lt;</span><span class="nv">br</span><span class="o">/&gt;&lt;</span><span class="nv">b</span><span class="o">&gt;</span><span class="nv">Visits</span>:<span class="o">&lt;/</span><span class="nv">b</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nv">i</span><span class="o">&gt;</span><span class="nv">cannot</span> <span class="k">connect</span> <span class="nv">to</span> <span class="nv">Redis</span>, <span class="nv">counter</span> <span class="nv">disabled</span><span class="o">&lt;/</span><span class="nv">i</span><span class="o">&gt;</span>
</pre></div>
</td></tr></table>

<p><strong>注意</strong>:
<code class="codehilite"><span class="n">EXPOSE</span></code>指令只是告诉容器向外部暴露的端口。
<code class="codehilite"><span class="o">-</span><span class="n">p</span> <span class="mi">4000</span><span class="p">:</span><span class="mi">80</span></code>是把容器的<code class="codehilite"><span class="mi">80</span></code>端口映射为宿主机的<code class="codehilite"><span class="mi">4000</span></code>端口。
<code class="codehilite"><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">p</span></code>会默认把<code class="codehilite"><span class="n">EXPOSE</span></code>的<code class="codehilite"><span class="mi">80</span></code>端口映射为宿主机的<code class="codehilite"><span class="mi">80</span></code>端口。</p>
<p>使用<code class="codehilite"><span class="o">-</span><span class="n">d</span></code>选项可以让容器以非阻塞的方式在后台运行，例如：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker run -p -d <span class="m">4000</span>:80 friendlyhello
2ee89a76e20b3d2e1aed89d3bd1dff40280a8649abdf756252fe334ece39f057
</pre></div>
</td></tr></table>

<p>使用<code class="codehilite"><span class="n">docker</span> <span class="n">ps</span></code>来查看当前正在运行的所有容器。使用<code class="codehilite"><span class="n">docker</span> <span class="n">stop</span> <span class="o">&lt;</span><span class="n">CONTAINER</span> <span class="n">ID</span><span class="o">&gt;</span></code>来停止容器的运行。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker ps 
CONTAINER ID        IMAGE                          COMMAND                  CREATED             STATUS              PORTS                            NAMES
2ee89a76e20b        friendlyhello                  <span class="s2">&quot;python app.py&quot;</span>          <span class="m">8</span> seconds ago       Up <span class="m">55</span> seconds       <span class="m">0</span>.0.0.0:8001-&gt;80/tcp             relaxed_pare


$ docker stop 2ee89a76e20b
2ee89a76e20b
</pre></div>
</td></tr></table>

<h2 id="_5">分享你创建的镜像给它人<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>为了证明你刚创建的镜像的可移植性，我们把它上传到登记处吧。</p>
<p>登记处是仓库的集合地，仓库是镜像的集合。在登记处创建一个帐号后，就可以上传一些仓库了。<code class="codehilite"><span class="n">docker</span></code>CLI默认使用<code class="codehilite"><span class="n">Docker</span></code>的公共登记处。</p>
<p><strong>注意</strong>: 我们使用<code class="codehilite"><span class="n">Docker</span></code>公共登记处只是因为它免费并且已经预先配置好了。我们当然可以选择其它的登记处来上传，也可以使用<code class="codehilite"><span class="n">Docker</span> <span class="k">Trusted</span> <span class="n">Registry</span></code>自己搭建私有登记处。</p>
<p>如果你在<code class="codehilite"><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">hub</span><span class="p">.</span><span class="n">docker</span><span class="p">.</span><span class="n">com</span></code>上面创建过帐号，你可以使用那个帐号来登录并上传你的镜像。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ <span class="nv">docker</span> <span class="nv">login</span>
<span class="nv">Login</span> <span class="nv">with</span> <span class="nv">your</span> <span class="nv">Docker</span> <span class="nv">ID</span> <span class="nv">to</span> <span class="nv">push</span> <span class="nv">and</span> <span class="nv">pull</span> <span class="nv">images</span> <span class="nv">from</span> <span class="nv">Docker</span> <span class="nv">Hub</span>. <span class="k">If</span> <span class="nv">you</span> <span class="nv">don</span><span class="s1">&#39;</span><span class="s">t have a Docker ID, head over to https://hub.docker.com to create one.</span>
<span class="nv">Username</span> <span class="ss">(</span><span class="nv">zhulongyixian</span><span class="ss">)</span>: 
<span class="nv">Password</span>: 
<span class="nv">Login</span> <span class="nv">Succeeded</span>
</pre></div>
</td></tr></table>

<p>emh1bG9uZ3lpeGlhbjpXdzU0Mzg1OTIzMAo=</p>
<h2 id="_6">给镜像打标签<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<p>给本地镜像打标签的格式是:<code class="codehilite"><span class="n">username</span><span class="o">/</span><span class="n">repository</span><span class="p">:</span><span class="n">tag</span></code>，<code class="codehilite"><span class="n">tag</span></code>是可选的, 默认为<code class="codehilite"><span class="n">latest</span></code>。<code class="codehilite"><span class="n">username</span></code>是你在登记处的帐户名称，<code class="codehilite"><span class="n">repository</span></code>是你在登记处自己帐号下面创建的仓库名称，<code class="codehilite"><span class="n">tag</span></code>就是你给镜像所打的标签了，可以用来作版本控制。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker tag friendlyhello zhulongyixian/hello:v1.0
</pre></div>
</td></tr></table>

<p>运行<code class="codehilite"><span class="n">docker</span> <span class="n">images</span></code>来查看镜像:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker images
REPOSITORY              TAG                 IMAGE ID            CREATED             SIZE
friendlyhello           latest              c44e612afbaf        About an hour ago   194MB
zhulongyixian/hello     v1.0                c44e612afbaf        About an hour ago   194MB
</pre></div>
</td></tr></table>

<h2 id="_7">发布你的镜像<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>$ docker push zhulongyixian/hello:v1.0
The push refers to a repository <span class="o">[</span>docker.io/zhulongyixian/hello<span class="o">]</span>
66ff03c1986b: Pushed 
11d6afaa575f: Pushed 
258c807552a6: Pushed 
735a46068813: Mounted from library/python 
2323e4886d1c: Mounted from library/python 
3dd73719e600: Mounted from library/python 
2c40c66f7667: Mounted from library/python 
v1.0: digest: sha256:8fbd239f550124a129ba0874c1634ac4c4b64835f544b66514eb579e00bfd5d4 size: <span class="m">1787</span>
</pre></div>
</td></tr></table>

<p>一旦完成发布，你就可以在<code class="codehilite"><span class="n">docker</span> <span class="n">hub</span></code>上面看到它，其它人也可以拉取你的镜像到自己的本地运行服务。</p>
<h2 id="_8">拉取你的镜像在其它地方运行<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">p</span> <span class="mi">4000</span><span class="p">:</span><span class="mi">80</span> <span class="n">zhulongyixian</span><span class="o">/</span><span class="n">hello</span><span class="p">:</span><span class="n">v1</span><span class="p">.</span><span class="mi">0</span>
</pre></div>
</td></tr></table>

<p><strong>注意</strong>:如果不指定<code class="codehilite"><span class="n">tag</span></code>，docker默认会使用<code class="codehilite"><span class="n">latest</span></code>来拉取镜像</p>
<h1 id="_9">常用指令列表<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h1>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nv">docker</span> <span class="nv">build</span> <span class="o">-</span><span class="nv">t</span> <span class="nv">friendlyname</span> .  # <span class="nv">Create</span> <span class="nv">image</span> <span class="nv">using</span> <span class="nv">this</span> <span class="nv">directory</span><span class="s1">&#39;</span><span class="s">s Dockerfile</span>
<span class="nv">docker</span> <span class="nv">run</span> <span class="o">-</span><span class="nv">p</span> <span class="mi">4000</span>:<span class="mi">80</span> <span class="nv">friendlyname</span>  # <span class="nv">Run</span> <span class="s2">&quot;</span><span class="s">friendlyname</span><span class="s2">&quot;</span> <span class="nv">mapping</span> <span class="nv">port</span> <span class="mi">4000</span> <span class="nv">to</span> <span class="mi">80</span>
<span class="nv">docker</span> <span class="nv">run</span> <span class="o">-</span><span class="nv">d</span> <span class="o">-</span><span class="nv">p</span> <span class="mi">4000</span>:<span class="mi">80</span> <span class="nv">friendlyname</span>         # <span class="nv">Same</span> <span class="nv">thing</span>, <span class="nv">but</span> <span class="nv">in</span> <span class="nv">detached</span> <span class="nv">mode</span>
<span class="nv">docker</span> <span class="nv">ps</span>                                 # <span class="nv">See</span> <span class="nv">a</span> <span class="nv">list</span> <span class="nv">of</span> <span class="nv">all</span> <span class="nv">running</span> <span class="nv">containers</span>
<span class="nv">docker</span> <span class="nv">stop</span> <span class="o">&lt;</span><span class="nv">hash</span><span class="o">&gt;</span>                     # <span class="nv">Gracefully</span> <span class="nv">stop</span> <span class="nv">the</span> <span class="nv">specified</span> <span class="nv">container</span>
<span class="nv">docker</span> <span class="nv">ps</span> <span class="o">-</span><span class="nv">a</span>           # <span class="nv">See</span> <span class="nv">a</span> <span class="nv">list</span> <span class="nv">of</span> <span class="nv">all</span> <span class="nv">containers</span>, <span class="nv">even</span> <span class="nv">the</span> <span class="nv">ones</span> <span class="nv">not</span> <span class="nv">running</span>
<span class="nv">docker</span> <span class="nv">kill</span> <span class="o">&lt;</span><span class="nv">hash</span><span class="o">&gt;</span>                   # <span class="nv">Force</span> <span class="nv">shutdown</span> <span class="nv">of</span> <span class="nv">the</span> <span class="nv">specified</span> <span class="nv">container</span>
<span class="nv">docker</span> <span class="nv">rm</span> <span class="o">&lt;</span><span class="nv">hash</span><span class="o">&gt;</span>              # <span class="nv">Remove</span> <span class="nv">the</span> <span class="nv">specified</span> <span class="nv">container</span> <span class="nv">from</span> <span class="nv">this</span> <span class="nv">machine</span>
<span class="nv">docker</span> <span class="nv">rm</span> $<span class="ss">(</span><span class="nv">docker</span> <span class="nv">ps</span> <span class="o">-</span><span class="nv">a</span> <span class="o">-</span><span class="nv">q</span><span class="ss">)</span>           # <span class="nv">Remove</span> <span class="nv">all</span> <span class="nv">containers</span> <span class="nv">from</span> <span class="nv">this</span> <span class="nv">machine</span>
<span class="nv">docker</span> <span class="nv">images</span> <span class="o">-</span><span class="nv">a</span>                               # <span class="k">Show</span> <span class="nv">all</span> <span class="nv">images</span> <span class="nv">on</span> <span class="nv">this</span> <span class="nv">machine</span>
<span class="nv">docker</span> <span class="nv">rmi</span> <span class="o">&lt;</span><span class="nv">imagename</span><span class="o">&gt;</span>            # <span class="nv">Remove</span> <span class="nv">the</span> <span class="nv">specified</span> <span class="nv">image</span> <span class="nv">from</span> <span class="nv">this</span> <span class="nv">machine</span>
<span class="nv">docker</span> <span class="nv">rmi</span> $<span class="ss">(</span><span class="nv">docker</span> <span class="nv">images</span> <span class="o">-</span><span class="nv">q</span><span class="ss">)</span>             # <span class="nv">Remove</span> <span class="nv">all</span> <span class="nv">images</span> <span class="nv">from</span> <span class="nv">this</span> <span class="nv">machine</span>
<span class="nv">docker</span> <span class="nv">login</span>             # <span class="nv">Log</span> <span class="nv">in</span> <span class="nv">this</span> <span class="nv">CLI</span> <span class="nv">session</span> <span class="nv">using</span> <span class="nv">your</span> <span class="nv">Docker</span> <span class="nv">credentials</span>
<span class="nv">docker</span> <span class="nv">tag</span> <span class="o">&lt;</span><span class="nv">image</span><span class="o">&gt;</span> <span class="nv">username</span><span class="o">/</span><span class="nv">repository</span>:<span class="nv">tag</span>  # <span class="nv">Tag</span> <span class="o">&lt;</span><span class="nv">image</span><span class="o">&gt;</span> <span class="k">for</span> <span class="nv">upload</span> <span class="nv">to</span> <span class="nv">registry</span>
<span class="nv">docker</span> <span class="nv">push</span> <span class="nv">username</span><span class="o">/</span><span class="nv">repository</span>:<span class="nv">tag</span>            # <span class="nv">Upload</span> <span class="nv">tagged</span> <span class="nv">image</span> <span class="nv">to</span> <span class="nv">registry</span>
<span class="nv">docker</span> <span class="nv">run</span> <span class="nv">username</span><span class="o">/</span><span class="nv">repository</span>:<span class="nv">tag</span>                   # <span class="nv">Run</span> <span class="nv">image</span> <span class="nv">from</span> <span class="nv">a</span> <span class="nv">registry</span>
</pre></div>
</td></tr></table><h2 id="__comments">评论</h2><div id="disqus_thread"></div><script>var disqus_config = function () {
      this.page.url = "http://blog.jokerhub.cn/docker/Container/";
      this.page.identifier =
        "/docker/Container/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//jokerhub-blog.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();</script></article></div></div></main><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../Orientation/" title="定位" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">后退</span>定位</span></div></a><a href="../Service/" title="服务" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">前进</span>服务</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">Created by Wang Zhizhou</div>powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div><div class="md-footer-social"><link rel="stylesheet" href="../../assets/fonts/font-awesome.css"> <a href="https://github.com/wangzhizhou" class="md-footer-social__link fa fa-github"></a>  <a href="https://twitter.com/w_z_z_1991" class="md-footer-social__link fa fa-twitter"></a>  <a href="https://linkedin.com/in/wangzhizhou" class="md-footer-social__link fa fa-linkedin"></a> </div></div></div></footer></div><script src="../../assets/javascripts/application.b260a35d.js"></script><script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script><script src="../../assets/javascripts/lunr/tinyseg.js"></script><script src="../../assets/javascripts/lunr/lunr.ja.js"></script><script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script><script src="../../javascripts/extra.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>